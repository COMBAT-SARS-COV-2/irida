<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="export/_base">

<head>
  <title th:text="${project.label} + ' - ' + #{project.nav.details}"></title>
  	<link rel="stylesheet" href="/resources/css/pages/sample_files.css"
	      th:href="@{/resources/css/pages/sample_files.css}"/>
</head>

<body>
  <main layout:fragment="main">
    <h1>_NCBI Export_</h1>
    <div class="form-group">
					<label class="col-sm-2 control-label" th:text="#{workflow.label.files}">Files</label>

					<div class="col-sm-10" th:with="dateFormat=#{locale.date.short}">
							<div th:id="${'sample-' + sample.id}" class="sample-container" th:each="sample : ${samples}">
								<h3>
									<a href="#" th:href="@{/projects/{id}/samples(id=${project.id})}"
									   th:text="${project.name + ' / ' + sample.name}"></a>
									<button type="button"
									        class="btn btn-xs btn-default pull-right remove remove-sample-button"
									        th:text="#{form.btn.remove}"
									        th:attr="ng-click=${'pipeline.removeSample('+project.id+','+sample.id+')'}">
										Remove
									</button>
								</h3>

								<!--/* (15-03-26 )
								Check to see if there are paired end or single end files that need to be displayed.
								 - Must have the proper key in the files hash and have items within the set.
								*/-->
								<th:block
									th:with="hasPaired=${#maps.containsKey(sample.files, 'paired_end') and #sets.size(sample.files.paired_end) &gt; 0},
								hasSingles=${#maps.containsKey(sample.files, 'single_end') and #sets.size(sample.files.single_end) &gt; 0}">
									<table class="table" th:if="${hasPaired or hasSingles}">

										<!--/* (15-03-26 ) PAIRED END DATA */-->
										<th:block th:if="${hasPaired}"
										          th:with="pairs=${sample.files.paired_end}">
											<th:block th:each="pair : ${pairs}">
												<tr class="paired_end paired_end__forward">
													<td class="td_radio" rowspan="2">
														<!--/* (15-03-26 ) Checked only if it is the first pair in the set. */-->
														<input type="checkbox" data-type="paired_end" th:value="${pair.getId()}" th:name="${sample.id}"/>
													</td>
													<td th:replace="templates/_sequenceFile :: sequenceFileTableLayout (file=${pair.getForwardSequenceFile()},icon='forward')"></td>
												</tr>
												<tr class="paired_end paired_end__reverse">
													<td th:replace="templates/_sequenceFile :: sequenceFileTableLayout (file=${pair.getReverseSequenceFile()},icon='reverse')"></td>
												</tr>
											</th:block>
										</th:block>

										<!--/* (15-03-26 ) SINGLE END DATA */-->
										<th:block th:if="${hasSingles}" th:with="files=${sample.files.single_end}">
											<tr class="single_end" th:each="join : ${files}" th:with="file=${join.getObject()}">
											<td class="td_radio">
												<!--/* (15-03-26 ) Checked only if there are no pairs and it is the first one in the file set */-->
												<input type="checkbox" data-type="single_end" th:value="${file.getId()}" th:name="${sample.id}"/>
											</td>
											<td th:replace="templates/_sequenceFile :: sequenceFileTableLayout (file=${file},icon='single')"></td>
										</tr>
										</th:block>
									</table>

									<!--/* (15-03-26 ) If there are no files available in this sample to run on the selected pipeline show a warning with no files. */-->
									<div th:unless="${hasPaired or hasSingles}" class="alert alert-warning">
										<strong
											class="fa fa-fw fa-ban"></strong>
										<th:block th:text="#{workflow.files.files-not-appropriate}"></th:block>
									</div>
								</th:block>

							</div>
                        
					</div>
				</div>
  </main>
  <th:block layout:fragment="scripts" th:inline="javascript">
  </th:block>
</body>

</html>
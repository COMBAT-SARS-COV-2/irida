<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      lang="en">
<head lang="en">
	<title layout:title-pattern="$DECORATOR_TITLE - $CONTENT_TITLE" th:text="#{global.title}">IRIDA Platform</title>
	<link rel="stylesheet" th:href="@{/resources/bower_components/Font-Awesome/css/font-awesome.min.css}"
	      href="/resources/bower_components/Font-Awesome/css/font-awesome.min.css"/>
	<link rel="stylesheet" th:href="@{/resources/bower_components/AngularJS-Toaster/toaster.css}"
	      href="/resources/bower_components/AngularJS-Toaster/toaster.css"/>
</head>
<body vocab="http://schema.org/" typeof="WebPage" id="ng-app" ng-app="irida">
<div toaster-container=""></div>

<div style="height: 100%;" ng-controller="CartCtrl as cart">
	<div style="height: 100%;" class="st-container" ng-class="{'cart-open':cart.show}">
		<div class="st-content">
			<div class="st-content-inner" layout:fragment="main-section">
			</div>
		</div>
		<aside class="cart">
			<section ng-hide="cart.projects.length">
				<p class="lead" th:text="#{cart.empty-text}"></p>
				<button class="btn btn-default" ng-click="cart.show=false" th:text="#{cart.btn.close}">Close</button>
			</section>
			<section ng-show="cart.projects.length">

				<button class="btn btn-default" ng-click="cart.show=false" th:text="#{cart.btn.close}">Close</button>
				<button class="btn btn-primary pull-right" th:text="#{cart.btn.run}">Run Pipeline</button>
			</section>
		</aside>
	</div>
</div>



<script src="/resources/bower_components/jquery/dist/jquery.min.js"
        th:src="@{/resources/bower_components/jquery/dist/jquery.min.js}"></script>
<script th:src="@{/resources/bower_components/lodash/dist/lodash.min.js}"
        src="/resources/bower_components/lodash/dist/lodash.min.js"></script>
<script th:src="@{/resources/bower_components/angular/angular.min.js}"
        src="/resources/bower_components/angular/angular.min.js"></script>
<script src="/resources/bower_components/angular-aria/angular-aria.min.js"
        th:src="@{/resources/bower_components/angular-aria/angular-aria.min.js}"></script>
<script th:src="@{/resources/bower_components/angular-animate/angular-animate.min.js}"
        src="/resources/bower_components/angular-animate/angular-animate.min.js"></script>
<script th:src="@{/resources/bower_components/angular-resource/angular-resource.min.js}"
        src="/resources/bower_components/angular-resource/angular-resource.min.js"></script>
<script th:src="@{'/resources/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js'}"
        src="/resources/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
<script th:src="@{/resources/bower_components/restangular/src/restangular.js}"
        src="/resources/bower_components/restangular/src/restangular.js"></script>

<script th:src="@{/resources/bower_components/AngularJS-Toaster/toaster.js}"
        src="/resources/bower_components/AngularJS-Toaster/toaster.js"></script>
<script th:src="@{/resources/js/services/notifications/irida-notifications.js}"
        src="/resources/js/services/notifications/irida-notifications-min.js"></script>

<script th:inline="javascript">
	/*<![CDATA[*/
	window.dependencies = _.union(window.dependencies || [], ['ngAria', 'ngResource', 'ngAnimate', 'ui.bootstrap', 'restangular', 'irida.notifications']);
	var interceptor = function ($q, $location) {
		return {
			request: function (config) {
				if (config.url.indexOf("/template") > -1) {
					config.headers.Accept = "text/html";
				}
				if (config.method === "POST") {
					config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
				}
				return config;
			}
		};
	};
	var app = angular.module('irida', window.dependencies)
		    .value('BASE_URL', /*[[@{/}]]*/ '/')
		    // This configures the base url globally for all restangular calls.
		    .config(function (RestangularProvider) {
			    RestangularProvider.setBaseUrl(/*[[@{/}]]*/);
		    })
		    .config(function ($httpProvider) {
			    $httpProvider.interceptors.push(interceptor);


			    // Make sure that all ajax form data is sent in the correct format.
			    $httpProvider.defaults.transformRequest = function (data) {
				    if (data === undefined) {
					    return data;
				    }
				    return $.param(data);
			    };
		    })
		    .run(function (paginationConfig) {
			    paginationConfig.firstText = /*[[#{table.first}]]*/ 'First';
			    paginationConfig.previousText = /*[[#{table.previous}]]*/ 'Previous';
			    paginationConfig.nextText = /*[[#{table.next}]]*/ 'Next';
			    paginationConfig.lastText = /*[[#{table.last}]]*/ 'Last';
			    paginationConfig.boundaryLinks = true;
			    paginationConfig.directionLinks = true;
			    paginationConfig.maxSize = 8;
			    paginationConfig.rotate = false;
		    })
		    .directive('ngFocus', [function () {
			    var FOCUS_CLASS = "ng-focused";
			    return {
				    restrict: 'A',
				    require : 'ngModel',
				    link    : function (scope, element, attrs, ctrl) {
					    ctrl.$focused = false;
					    element.bind('focus', function (evt) {
						    element.addClass(FOCUS_CLASS);
						    scope.$apply(function () {
							    ctrl.$focused = true;
						    });
					    }).bind('blur', function (evt) {
						    element.removeClass(FOCUS_CLASS);
						    scope.$apply(function () {
							    ctrl.$focused = false;
						    });
					    });
				    }
			    }
		    }])
		    .controller('CartCtrl', [function () {
			    "use strict";
			    var vm = this;
			    vm.show = false;
			    vm.projects = [];
		    }])
		;
	/*]]>*/
</script>

<th:block layout:fragment="theme-scripts">
	<!--/* This is where the main for the theme template are loaded. */-->
</th:block>

<th:block layout:fragment="page-scripts">
	<!--/* This is where scripts specific for each page should be loaded. */-->
</th:block>
</body>
</html>
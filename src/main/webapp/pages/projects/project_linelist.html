<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorator="projects/_base">
<head>
    <title th:text="#{linelist.page-title}">Title</title>
    <!-- TODO: (Josh) Move this to external css file -->
    <style>
        .metadata-open .modal-content {
            padding: 1rem;
        }

        .metadata-open .scroll-col .btn.active {
            background: #388E3C !important;
            color: #ffffff !important;
        }

        .scroll-col {
            overflow-y: scroll !important;
            overflow-x: hidden;
            padding: 0 !important;
        }
    </style>
</head>
<body>
<main layout:fragment="main" ddl:bundle-includes="project-linelist">
    <div class="row spaced-bottom">
        <div class="col-md-12">
            <metadata-component></metadata-component>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12" style="overflow: hidden;">
            <table id="linelist" class="table table-bordered table-striped" style="width: 100%;"></table>
        </div>
    </div>

</main>

<th:block layout:fragment="scripts">
    <script th:inline="javascript">
        var metadataList = /*[[${metadataList}]]*/ [];
        var headersList = /*[[${headers}]]*/ [];
    </script>
    <script type="text/ng-template" id="metadata.button.tmpl">
        <div class="btn-group">
            <button class="btn btn-default" ng-click="$ctrl.showMetadataTemplator()"
                    th:text="#{linelist.datatable.column-select.button}">_Header Fields_
            </button>
            <a class="btn btn-default"
               th:href="@{/projects/{id}/sample-metadata(id=${project.getId()})}"
               th:text="#{linelist.add-metadata.btn}">_Upload new metadata_</a></div>
    </script>
    <script type="text/ng-template" id="metadata.aside.tmpl">
        <div class="row" style="height: 100%;">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-sm-12">
                        <Label th:text="#{linelist.columns.select-metadata.label}">
                            _Select metadata columns to display_</Label>
                    </div>
                </div>
                <div class="col-md-12 scroll-col">
                    <div class="row spaced-bottom"
                         ng-repeat="field in $ctrl.fields track by $index">
                        <div class="col-sm-12">
                            <input type="checkbox"
                                   ng-change="$ctrl.toggleField(field)"
                                   bs-switch=""
                                   switch-size="small"
                                   switch-on-color="success"
                                   ng-model="field.selected"
                                   switch-label-width="200"
                                   switch-label="{{ field.text }}"
                                   switch-readonly="{{ $index === 0 }}"
                            />
                            <small class="text-info" ng-if="$index === 0" th:text="#{linelist.columns.first-warning}">_First column can not be hidden._</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </script>
    <script src="/resources/js/build/project-linelist.bundle.js"
        th:src="@{/resources/js/build/project-linelist.bundle.js}"></script>
</th:block>
</body>
</html>
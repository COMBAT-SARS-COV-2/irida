<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="projects/settings/_base">
<head>
    <title th:text="#{project.settings.page.title.members}">Title</title>
    <script th:inline="javascript">
      var PAGE = {
        i18n: {
          'remove': /*[[#{project.members.edit.remove}]]*/ '_Remove user from project_'

        },
        urls: {
          'addMember': /*[[@{/projects/{id}/settings/members(id=${project.getId()})}]]*/ '/projects/1/settings/members',
          'usersLink': /*[[@{/users/}]]*/'/users',
          'deleteModal': /*[[@{/projects/settings/removeUserModal}]]*/ '/projects/settings/removeUserModal',
          'removeMember': /*[[@{/projects/{id}/settings/members/(id=${project.getId()})}]]*/ '/projects/1/settings/members/2',
          'usersSelection': /*[[@{/projects/{id}/settings/ajax/availablemembers(id=${project.getId()})}]]*/ '/projects/1/settings/ajax/availablemembers',
          'updateRole': /*[[@{/projects/{id}/settings/members/editrole/(id=${project.getId()})}]]*/ '/projects/1/settings/members'
        }
      };
    </script>
</head>
<body>
<div layout:fragment="settings-content">
    <!--<div dt:conf="usersTable">-->
    <!--<div dt:confType="callback" dt:type="createdRow" dt:function="project-members#projectMembersTable.rowRenderedCallback" />-->
    <!--<div dt:confType="extrahtml" dt:uid="2">-->
    <!--</div>-->
    <!--</div>-->
    <div class="row">
        <div class="col-md-12">
            <table id="usersTable" class="table table-striped" cellspacing="0" width="100%"
                   data:url="@{/projects/{id}/settings/ajax/members(id=${project.getId()})}">
                <thead>
                <tr>
                    <th data:data="object.username" dt:searchable="true"
                        th:text="#{project.table.collaborator.name}"></th>
                    <th data:data="projectRole" th:if="${isAdmin} or ${manageMembers}"
                        th:text="#{project.table.collaborator.role}"></th>
                    <th data:data="projectRole" th:if="not (${isAdmin} or ${manageMembers})"
                        th:text="#{project.table.collaborator.role}"></th>
                    <th data:data="createdDate" class="dt-date" dt:property="createdDate"
                        th:text="#{project.table.collaborator.since}"></th>
                    <th width="30px" data-orderable="false" th:if="${isAdmin} or ${manageMembers}"></th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="modal fade" id="removeMemberModal" role="dialog" aria-labelledBy="#deleteConfirmTitle"></div>
    <div class="modal fade" id="addMemberModal" role="dialog" aria-labelledby="#addMemberTitle">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" data:aria-label="#{form.btn.close}">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title" id="addMemberTitle" th:text="#{project.members.edit.add}">_Add User_</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="control-label" for="add-member-membername"
                               th:text="#{project.members.add.username}">
                        </label>

                        <select id="add-member-membername" name="memberId" class="form-control input-full"
                                th:placeholder="#{project.members.add.select-user}"></select>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="add-member-role" th:text="#{project.members.add.role}">_Group
                            Role_</label>
                        <select id="add-member-role" class="form-control input-full" name="groupRole">
                            <option th:each="role : ${projectRoles}"
                                    th:value="${role}"
                                    th:text="#{${'projectRole.'+role}}">_Role_
                            </option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" type="button" data-dismiss="modal"
                            th:text="#{project.members.add.cancel}">_Cancel_
                    </button>
                    <button id="submitAddMember" class="btn btn-primary" type="button"
                            th:text="#{project.members.add.ok}">_OK_
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="hidden" id="role-template-wrapper">
        <th:block th:if="${isAdmin} or ${manageMembers}">
            <select class="form-control input-full project-role-select">
                <option value="PROJECT_USER" th:text="#{projectRole.PROJECT_USER}"></option>
                <option value="PROJECT_OWNER" th:text="#{projectRole.PROJECT_OWNER}"></option>
            </select>
        </th:block>
        <th:block th:unless="${isAdmin} or ${manageMembers}">
            <span class="PROJECT_USER" th:text="#{projectRole.PROJECT_USER}"></span>
            <span class="PROJECT_OWNER" th:text="#{projectRole.PROJECT_OWNER}"></span>
        </th:block>
    </div>
    <div th:if="${isAdmin} or ${manageMembers}" class="hidden" id="toolbar-wrapper">
        <div id="table-toolbar" class="btn-toolbar spaced-bottom" role="toolbar">
            <div class="btn-group">
                <button id="add-members-button" class="btn btn-default btn-sm"
                        type="button" data-toggle="modal" data-target="#addMemberModal"
                        th:if="${isAdmin} or ${manageMembers}" href="#addMembersLink"
                        th:text="#{project.members.edit.add}">_Add Members_
                </button>
            </div>
        </div>
    </div>
</div>
<th:block layout:fragment="scripts">
    <script th:src="@{/resources/js/build/project-members.bundle.js}"></script>
</th:block>
</body>
</html>
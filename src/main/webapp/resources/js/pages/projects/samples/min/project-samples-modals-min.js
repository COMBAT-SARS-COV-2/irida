!function(e,$,t,o,r,l,n){"use strict";function a(e){function t(t){return e.open({templateUrl:t.url+"&"+$.param({sampleIds:t.selectedSamples}),openedClass:"copy-modal",controllerAs:"copyModalCtrl",controller:["$uibModalInstance",function(e){var o=this;o.generateSelect2=function(){return function(e){return e.projects.filter(function(e){return e.identifier!=n.id}).map(function(e){return{id:e.identifier,text:e.text||e.name}})}},o.cancel=function(){e.dismiss()},o.doCopy=function(){e.close({sampleIds:t.selectedSamples,newProjectId:o.project})}}]}).result}function r(e){return t({selectedSamples:e,url:l.urls.modals.move})}function a(e){return t({selectedSamples:e,url:l.urls.modals.copy})}function s(t){return e.open({templateUrl:l.urls.modals.remove+"?"+$.param({sampleIds:t}),openedClass:"remove-modal",controllerAs:"removeCtrl",controller:["$uibModalInstance",function(e){var t=this;t.cancel=function(){e.dismiss()},t.remove=function(){e.close()}}]}).result}function i(t){return e.open({templateUrl:l.urls.modals.merge+"?"+$.param({sampleIds:t}),openedClass:"merge-modal",controllerAs:"mergeCtrl",controller:"MergeController",resolve:{samples:function(){return t}}}).result}function c(t){return e.open({templateUrl:"associated-projects.modal.html",controllerAs:"associatedProjectsCtrl",controller:"AssociatedProjectsModalController",resolve:{display:function(){return t}}}).result}function d(){return e.open({templateUrl:"filter.modal.html",controllerAs:"filterCtrl",openedClass:"filter-modal",controller:"FilterModalController"}).result}function p(t){var r=e.open({templateUrl:l.urls.samples.linker+"?"+$.param({projectId:l.project.id,ids:t}),controllerAs:"lCtrl",controller:["$uibModalInstance",function(e){var t=this;t.close=e.close}]});return r.opened.then(function(){new o(".clipboard-btn")}),r.result}return{openFilterModal:d,openMoveModal:r,openCopyModal:a,openRemoveModal:s,openMergeModal:i,openAssociatedProjectsModal:c,openLinkerModal:p}}function s(t,o,l){var n=this;n.projects={},n.display=e.copy(l),n.local={},o.getLocal().then(function(e){n.projects.local=[],e.data.forEach(function(e){var t=new r(e);t.selected=n.display.local.indexOf(t.getId())>-1,n.projects.local.push(t)})}),n.rowClick=function(e){e.stopPropagation()},n.close=function(){t.dismiss()},n.showProjects=function(){n.display.local=[],n.projects.local.forEach(function(e){e.selected&&n.display.local.push(e.getId())}),t.close(n.display)}}function i(e,t){var o=this;o.selected=t[0],o.validNameRE=/^[a-zA-Z0-9-_]+$/,o.cancel=function(){e.dismiss()},o.doMerge=function(){e.close({ids:t,mergeSampleId:o.selected,newName:o.name})}}function c(t){var o={date:{startDate:null,endDate:null}},r={};e.copy(o,r),this.getState=function(){var t={};return e.copy(r,t),t},this.setState=function(o){e.copy(o,r),t.$broadcast("FILTER_TABLE",{filter:{name:o.name,minDate:o.date.startDate?o.date.startDate.valueOf():"",endDate:o.date.endDate?o.date.endDate.valueOf():""}})},t.$on("CLEAR_FILTERS",function(){e.copy(o,r)}),t.$on("CLEAR_FILTER_PROPERTY",function(e,o){void 0!==r[o.property]&&r[o.property].length>0?delete r[o.property]:r.date[o.property]&&(r.date[o.property]=null),t.$broadcast("FILTER_TABLE",{filter:r})})}function d(e,o){var r=this;r.filter=o.getState(),r.options={ranges:{}},r.options.ranges[l.i18n.dateFilter.days30]=[t().subtract(30,"days"),t()],r.options.ranges[l.i18n.dateFilter.days60]=[t().subtract(60,"days"),t()],r.options.ranges[l.i18n.dateFilter.days120]=[t().subtract(120,"days"),t()],null!==r.filter.date.startDate&&(r.options.startDate=r.filter.date.startDate),null!==r.filter.date.endDate&&(r.options.endDate=r.filter.date.endDate),r.cancel=function(){e.dismiss()},r.doFilter=function(){o.setState(r.filter),e.dismiss()}}e.module("irida.projects.samples.modals",["irida.projects.samples.service","irida.directives.select2","ngMessages","ui.bootstrap","daterangepicker"]).factory("modalService",["$uibModal",a]).service("FilterStateService",["$rootScope",c]).controller("AssociatedProjectsModalController",["$uibModalInstance","AssociatedProjectsService","display",s]).controller("MergeController",["$uibModalInstance","samples",i]).controller("FilterModalController",["$uibModalInstance","FilterStateService",d])}(window.angular,window.jQuery,window.moment,window.Clipboard,window.Project,window.PAGE,window.project);
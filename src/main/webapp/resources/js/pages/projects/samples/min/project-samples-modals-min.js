!function(e,$,t,o,r){"use strict";function l(e){function t(t){return e.open({templateUrl:t.url+"&"+$.param({sampleIds:t.selectedSamples}),openedClass:"copy-modal",controllerAs:"copyModalCtrl",controller:["$uibModalInstance",function(e){var o=this;o.generateSelect2=function(){return function(e){return e.projects.filter(function(e){return e.identifier!=r.id}).map(function(e){return{id:e.identifier,text:e.text||e.name}})}},o.cancel=function(){e.dismiss()},o.doCopy=function(){e.close({sampleIds:t.selectedSamples,newProjectId:o.project})}}]}).result}function l(e){return t({selectedSamples:e,url:o.urls.modals.move})}function n(e){return t({selectedSamples:e,url:o.urls.modals.copy})}function a(t){return e.open({templateUrl:o.urls.modals.remove+"?"+$.param({sampleIds:t}),openedClass:"remove-modal",controllerAs:"removeCtrl",controller:["$uibModalInstance",function(e){var t=this;t.cancel=function(){e.dismiss()},t.remove=function(){e.close()}}]}).result}function s(t){return e.open({templateUrl:o.urls.modals.merge+"?"+$.param({sampleIds:t}),openedClass:"merge-modal",controllerAs:"mergeCtrl",controller:"MergeController",resolve:{samples:function(){return t}}}).result}function i(t){return e.open({templateUrl:"associated-projects.modal.html",controllerAs:"associatedProjectsCtrl",controller:"AssociatedProjectsModalController",resolve:{display:function(){return t}}}).result}function c(){return e.open({templateUrl:"filter.modal.html",controllerAs:"filterCtrl",openedClass:"filter-modal",controller:"FilterModalController"}).result}function d(t){var r=e.open({templateUrl:o.urls.samples.linker+"?"+$.param({projectId:o.project.id,ids:t}),controllerAs:"lCtrl",controller:["$uibModalInstance",function(e){var t=this;t.close=e.close}]});return r.opened.then(function(){new Clipboard(".clipboard-btn")}),r.result}return{openFilterModal:c,openMoveModal:l,openCopyModal:n,openRemoveModal:a,openMergeModal:s,openAssociatedProjectsModal:i,openLinkerModal:d}}function n(t,o,r){var l=this;l.projects={},l.display=e.copy(r),l.local={},o.getLocal().then(function(e){l.projects.local=[],e.data.forEach(function(e){var t=new Project(e);t.selected=l.display.local.indexOf(t.getId())>-1,l.projects.local.push(t)})}),l.rowClick=function(e){e.stopPropagation()},l.close=function(){t.dismiss()},l.showProjects=function(){l.display.local=[],l.projects.local.forEach(function(e){e.selected&&l.display.local.push(e.getId())}),t.close(l.display)}}function a(e,t){var o=this;o.selected=t[0],o.validNameRE=/^[a-zA-Z0-9-_]+$/,o.cancel=function(){e.dismiss()},o.doMerge=function(){e.close({ids:t,mergeSampleId:o.selected,newName:o.name})}}function s(e){var t={date:{startDate:null,endDate:null}},o=_.clone(t);this.getState=function(){return _.clone(o)},this.setState=function(t){o=_.clone(t),e.$broadcast("FILTER_TABLE",{filter:{name:t.name,minDate:t.date.startDate?t.date.startDate.valueOf():"",endDate:t.date.endDate?t.date.endDate.valueOf():""}})},e.$on("CLEAR_FILTERS",function(){o=_.clone(t)}),e.$on("CLEAR_FILTER_PROPERTY",function(t,r){void 0!==o[r.property]&&o[r.property].length>0?delete o[r.property]:o.date[r.property]&&(o.date[r.property]=null),e.$broadcast("FILTER_TABLE",{filter:o})})}function i(e,r){var l=this;l.filter=r.getState(),l.options={ranges:{}},l.options.ranges[o.i18n.dateFilter.days30]=[t().subtract(30,"days"),t()],l.options.ranges[o.i18n.dateFilter.days60]=[t().subtract(60,"days"),t()],l.options.ranges[o.i18n.dateFilter.days120]=[t().subtract(120,"days"),t()],null!==l.filter.date.startDate&&(l.options.startDate=l.filter.date.startDate),null!==l.filter.date.endDate&&(l.options.endDate=l.filter.date.endDate),l.cancel=function(){e.dismiss()},l.doFilter=function(){r.setState(l.filter),e.dismiss()}}e.module("irida.projects.samples.modals",["irida.projects.samples.service","irida.directives.select2","ngMessages","ui.bootstrap","daterangepicker"]).factory("modalService",["$uibModal",l]).service("FilterStateService",["$rootScope",s]).controller("AssociatedProjectsModalController",["$uibModalInstance","AssociatedProjectsService","display",n]).controller("MergeController",["$uibModalInstance","samples",a]).controller("FilterModalController",["$uibModalInstance","FilterStateService",i])}(window.angular,window.jQuery,window.moment,window.PAGE,window.project);